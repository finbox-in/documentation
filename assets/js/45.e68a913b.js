(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{343:function(t,e,a){"use strict";a.r(e);var s=a(8),n=Object(s.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"bankconnect-webhook"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#bankconnect-webhook"}},[t._v("#")]),t._v(" BankConnect: Webhook")]),t._v(" "),e("p",[t._v("You can also configure a custom web hook to be invoked whenever the extraction process is completed or failed (because of extraction failure in manual mode or user entering the wrong credentials for example in net banking mode).")]),t._v(" "),e("p",[t._v("To configure this, you have to share with us a "),e("strong",[t._v("valid endpoint")]),t._v(".")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("A Valid Endpoint:")]),t._v(" "),e("ul",[e("li",[t._v("receives a POST request")]),t._v(" "),e("li",[t._v("receives a request body with content-type "),e("code",[t._v("application/json")])]),t._v(" "),e("li",[t._v("returns a 200 status code on successful reception.")])])]),t._v(" "),e("h2",{attrs:{id:"authentication"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#authentication"}},[t._v("#")]),t._v(" Authentication")]),t._v(" "),e("p",[t._v("FinBox BankConnect REST API uses API keys to authenticate requests. All API requests must be made over HTTPS. Calls made over plain HTTP will fail. API requests without authentication will also fail.")]),t._v(" "),e("p",[t._v("To make a successful request, required "),e("strong",[t._v("headers mentioned with each API")]),t._v(" must be present in the request.")]),t._v(" "),e("p",[t._v("In case wrong/incomplete/no keys were passed in headers, response will have "),e("strong",[t._v("401")]),t._v(" HTTP Code and payload as follows:")]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"detail"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Authentication credentials were not provided."')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("h2",{attrs:{id:"updating-web-hook-endpoint"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#updating-web-hook-endpoint"}},[t._v("#")]),t._v(" Updating web hook endpoint")]),t._v(" "),e("p",[t._v("To update your valid endpoint use the API below:")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("Endpoint")]),t._v(" "),e("p",[t._v("POST "),e("strong",[t._v(t._s(t.$page.frontmatter.base_url)+"/"+t._s(t.$page.frontmatter.version)+"/entity/update_webhook/")])])]),t._v(" "),e("h3",{attrs:{id:"authentication-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#authentication-2"}},[t._v("#")]),t._v(" Authentication")]),t._v(" "),e("p",[t._v("Request headers "),e("code",[t._v("x-api-key")]),t._v(" with API Key as value and "),e("code",[t._v("server-hash")]),t._v(" with Server Hash as value must be present in request.")]),t._v(" "),e("h3",{attrs:{id:"request-body"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#request-body"}},[t._v("#")]),t._v(" Request Body")]),t._v(" "),e("p",[t._v("It receives following "),e("strong",[t._v("request body")]),t._v(" in "),e("code",[t._v("application/json")]),t._v(" content type:")]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"webhook_url"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://postman-echo.com/post"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("Here, "),e("code",[t._v("https://postman-echo.com/post")]),t._v(" is an example for valid endpoint.")]),t._v(" "),e("h3",{attrs:{id:"response"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#response"}},[t._v("#")]),t._v(" Response")]),t._v(" "),e("p",[t._v("On updating the web hook endpoint successfully, the "),e("code",[t._v("update_webhook")]),t._v(" API will give "),e("strong",[t._v("200 Status Code")]),t._v(".")]),t._v(" "),e("div",{staticClass:"custom-block danger"},[e("p",{staticClass:"custom-block-title"},[t._v("IMPORTANT")]),t._v(" "),e("p",[t._v("By default web hook is enabled only for net banking mode, in case you want it to be enabled for manual mode as well, then you need to pass an additional field "),e("code",[t._v("webhook_mode")]),t._v(" with a value "),e("code",[t._v("1")]),t._v(". Hence the payload will look like this:")]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"webhook_url"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://postman-echo.com/post"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"webhook_mode"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("Make sure to specify webhook mode every time you update webhook in case you want web hook to be invoked for both manual as well as net banking mode, if not specified "),e("code",[t._v("webhook_mode")]),t._v(" will reset to the default value "),e("code",[t._v("0")]),t._v(" (Net Banking Mode only)")])]),t._v(" "),e("h2",{attrs:{id:"receiving-payload"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#receiving-payload"}},[t._v("#")]),t._v(" Receiving payload")]),t._v(" "),e("p",[t._v("We'll be sending JSON encoded body in the following payload format:")]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"entity_id"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"unique_entity_id"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"statement_id"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"unique_statement_id"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"link_id"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"link_id"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"progress"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"completed"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"reason"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("Here, the "),e("code",[t._v("progress")]),t._v(" field can be "),e("code",[t._v("completed")]),t._v(" or "),e("code",[t._v("failed")]),t._v(". In case the value is "),e("code",[t._v("failed")]),t._v(", "),e("code",[t._v("reason")]),t._v(" field will specify the reason for failure.")]),t._v(" "),e("p",[t._v("In case of failure in Net Banking Mode, an actual upload might not have happened, as in case of wrong credentials entered by the user, hence "),e("code",[t._v("statement_id")]),t._v(" will be unavailable, and will be a blank string "),e("code",[t._v('""')]),t._v(". Similarly in the case of manual upload if "),e("code",[t._v("link_id")]),t._v(" doesn't exist, its value will be "),e("code",[t._v("null")]),t._v(".")]),t._v(" "),e("h2",{attrs:{id:"handling-cases-when-your-webhook-endpoint-is-down"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#handling-cases-when-your-webhook-endpoint-is-down"}},[t._v("#")]),t._v(" Handling cases when your webhook endpoint is down")]),t._v(" "),e("p",[t._v("In case your webhook endpoint is down or a webhook call was failed, you can have the polling mechanism as a backup. However, the polling mechanism requires you to have the "),e("code",[t._v("entity_id")]),t._v(".")]),t._v(" "),e("p",[t._v("In case you just have the "),e("code",[t._v("link_id")]),t._v(" you can also request for all the webhook payloads for a given "),e("code",[t._v("link_id")]),t._v(" using the following API:")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("Endpoint")]),t._v(" "),e("p",[t._v("GET "),e("strong",[t._v(t._s(t.$page.frontmatter.base_url)+"/"+t._s(t.$page.frontmatter.version)+"/entity/webhook_payloads/?link_id="),e("code",[t._v("link_id")])])])]),t._v(" "),e("h3",{attrs:{id:"authentication-3"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#authentication-3"}},[t._v("#")]),t._v(" Authentication")]),t._v(" "),e("p",[t._v("Request headers "),e("code",[t._v("x-api-key")]),t._v(" with API Key as value and "),e("code",[t._v("server-hash")]),t._v(" with Server Hash as value must be present in request.")]),t._v(" "),e("h3",{attrs:{id:"response-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#response-2"}},[t._v("#")]),t._v(" Response")]),t._v(" "),e("p",[t._v("Response format will be as follows:")]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"payloads"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"statement_id"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"STATEMENT_UUID4"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"entity_id"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ENTITY_UUID4"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"link_id"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"LINK ID HERE"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"progress"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"completed"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"reason"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"date_time"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2020-03-06 12:46:33"')]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        ....\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("This API returns the data in decreasing order of time, i.e. the latest payloads will be on top and the oldest on the bottom. In each of the payload there is an additional field "),e("code",[t._v("date_time")]),t._v(" which indicates the date and time at which the webhook payload was supposed to be sent. "),e("code",[t._v("date_time")]),t._v(" is in "),e("code",[t._v("YYYY-MM-DD HH:MM:SS")]),t._v(" format.")]),t._v(" "),e("p",[t._v("In case you have "),e("code",[t._v("entity_id")]),t._v(" you can also poll the transactions API and check for the "),e("code",[t._v("progress")]),t._v(" field.")])])}),[],!1,null,null,null);e.default=n.exports}}]);