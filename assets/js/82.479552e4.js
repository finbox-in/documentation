(window.webpackJsonp=window.webpackJsonp||[]).push([[82],{380:function(t,s,e){"use strict";e.r(s);var a=e(8),r=Object(a.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"account-aggregator-recurring-pull"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#account-aggregator-recurring-pull"}},[t._v("#")]),t._v(" Account Aggregator Recurring Pull")]),t._v(" "),s("p",[t._v("This guide describes how to implement the AA Recurring Pull flow using BankConnect.\nThe flow is divided into Frontend and Backend components and uses a series of APIs to manage consents and retrieve recurring data.")]),t._v(" "),s("h2",{attrs:{id:"_1-implementation-overview"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-implementation-overview"}},[t._v("#")]),t._v(" 1. Implementation Overview")]),t._v(" "),s("p",[t._v("The AA Recurring flow consists of the following steps:")]),t._v(" "),s("img",{attrs:{src:"/aa-recurring-pull.png",alt:"Recurring Pull Workflow"}}),t._v(" "),s("h2",{attrs:{id:"_2-frontend-flow"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-frontend-flow"}},[t._v("#")]),t._v(" 2. Frontend Flow")]),t._v(" "),s("ol",[s("li",[s("em",[s("strong",[t._v("Take Recurring Consent")])])])]),t._v(" "),s("ul",[s("li",[t._v("A separate recurring consent must be collected from the user.")]),t._v(" "),s("li",[t._v("Trigger the BankConnect SDK via the Session API including the additional recurring-consent parameters.")])]),t._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[s("em",[s("strong",[t._v("User Approval")])])])]),t._v(" "),s("ul",[s("li",[t._v("The SDK opens using the redirect_url.")]),t._v(" "),s("li",[t._v("User approves the recurring consent.")]),t._v(" "),s("li",[t._v("After successful approval, user is redirected back to your frontend.")])]),t._v(" "),s("h2",{attrs:{id:"_3-backend-flow"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-backend-flow"}},[t._v("#")]),t._v(" 3. Backend Flow")]),t._v(" "),s("ol",[s("li",[s("em",[s("strong",[t._v("Handle Consent")])])])]),t._v(" "),s("ul",[s("li",[t._v("Use the session_id received from the Session API after the user completes the AA flow.")])]),t._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[s("em",[s("strong",[t._v("Get Recurring Consent Details")])])])]),t._v(" "),s("ul",[s("li",[t._v("Call the Get Recurring Consent Details API using the session_id.")]),t._v(" "),s("li",[t._v("Store the consent_id for future periodic data pulls.")])]),t._v(" "),s("ol",{attrs:{start:"3"}},[s("li",[s("em",[s("strong",[t._v("Store Consent ID")])])])]),t._v(" "),s("ul",[s("li",[t._v("Persist the consent_id and its metadata for automated recurring pulls.")])]),t._v(" "),s("ol",{attrs:{start:"4"}},[s("li",[s("em",[s("strong",[t._v("Fetch Recurring AA Data")])])])]),t._v(" "),s("ul",[s("li",[t._v("Use the Fetch Recurring AA Data API")]),t._v(" "),s("li",[t._v("Pass consent_id, date_time_range_from, and date_time_range_to.")])]),t._v(" "),s("ol",{attrs:{start:"5"}},[s("li",[s("em",[s("strong",[t._v("Check Status")])])])]),t._v(" "),s("ul",[s("li",[t._v("Monitor the status of the fetch job via Webhook events, or Polling APIs")])]),t._v(" "),s("ol",{attrs:{start:"6"}},[s("li",[s("em",[s("strong",[t._v("Retrieve Enriched Data")])])])]),t._v(" "),s("ul",[s("li",[t._v("Once processing is completed, call the Insights API")])]),t._v(" "),s("h3",{attrs:{id:"get-recurring-consent-details-api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#get-recurring-consent-details-api"}},[t._v("#")]),t._v(" Get Recurring Consent Details API")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("Endpoint")]),t._v(" "),s("p",[t._v("POST "),s("strong",[t._v(t._s(t.$page.frontmatter.base_url)+"/"+t._s(t.$page.frontmatter.version)+"/account_aggregator/get_recurring_consent_details/?session_id=<session_id>/")])])]),t._v(" "),s("p",[s("strong",[t._v("Success Response")])]),t._v(" "),s("p",[t._v("On successful API call, it gives a "),s("strong",[t._v("200 HTTP code")]),t._v(" with a response in following format:")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"consent_details"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"consent_id"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8d5fa22b-216a-54e2-90da-65d1c67c8964"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"bank_name"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hdfc"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"masked_account_number"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"XXXXXXXXXXX2304"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"tenure_month_count"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"frequency_unit"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"day"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"frequency_value"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"fetch-aa-recurring-data-api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#fetch-aa-recurring-data-api"}},[t._v("#")]),t._v(" Fetch AA Recurring Data API")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("Endpoint")]),t._v(" "),s("p",[t._v("POST "),s("strong",[t._v(t._s(t.$page.frontmatter.base_url)+"/"+t._s(t.$page.frontmatter.version)+"/account_aggregator/fetch_recurring_aa_data/")])])]),t._v(" "),s("p",[s("strong",[t._v("Sample Request")])]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"consent_id"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"xxxx"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"date_time_range_from"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"10/10/2025"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"date_time_range_to"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"10/11/2025"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[s("strong",[t._v("Success Response")])]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"session_id"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"new-session-id"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"status-check-enriched-apis"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#status-check-enriched-apis"}},[t._v("#")]),t._v(" Status Check & Enriched APIs")]),t._v(" "),s("p",[t._v("You can now:")]),t._v(" "),s("ul",[s("li",[t._v("Poll using the new session_id")]),t._v(" "),s("li",[t._v("Or wait for webhook")])]),t._v(" "),s("p",[t._v("Then call:")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:""}},[t._v("Transactions API")]),t._v(" (For Collections Usecase)")]),t._v(" "),s("li",[s("RouterLink",{attrs:{to:"/session-flow/fetch-data.html#insights-api"}},[t._v("Insights API")]),t._v(" (For Monitoring Usecase)")],1)]),t._v(" "),s("h3",{attrs:{id:"error-codes"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#error-codes"}},[t._v("#")]),t._v(" Error Codes")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("Error Code")]),t._v(" "),s("th",[t._v("Meaning")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("INVALID_SESSION_ID")]),t._v(" "),s("td",[t._v("Session is invalid, expired, or closed")])]),t._v(" "),s("tr",[s("td",[t._v("INVALID_CONSENT_ID")]),t._v(" "),s("td",[t._v("Consent not found or not linked to session")])]),t._v(" "),s("tr",[s("td",[t._v("CONSENT_REVOKED")]),t._v(" "),s("td",[t._v("User has revoked the recurring consent")])]),t._v(" "),s("tr",[s("td",[t._v("CONSENT_OVERUSED")]),t._v(" "),s("td",[t._v("Consent usage limit exhausted per Sahamati rules")])]),t._v(" "),s("tr",[s("td",[t._v("INVALID_DATE_RANGE")]),t._v(" "),s("td",[t._v("Date range invalid for recurring pull")])])])])])}),[],!1,null,null,null);s.default=r.exports}}]);